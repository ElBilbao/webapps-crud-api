<!-- This file is given to the client in the main route -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Adding a new product</title>
  </head>
  <body>
    <h1>Input data for the new product</h1>
    <form>
      <label for="txtName">Name:</label>
      <input type="text" id="txtName" value="" /><br />

      <label for="txtPrice">Price:</label>
      <input type="number" id="txtPrice" /><br />

      <label for="txtBrand">Brand:</label>
      <input type="text" id="txtBrand" /><br />

      <input type="submit" id="submit" value="Add product" />
    </form>

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      const txtName = document.getElementById("txtName");
      const txtPrice = document.getElementById("txtPrice");
      const txtBrand = document.getElementById("txtBrand");

      const btnSubmit = document.getElementById("submit");
      btnSubmit.addEventListener("click", (e) => {
        e.preventDefault();

        let name = txtName.value.trim();
        let price = txtPrice.value.trim();
        let brand = txtBrand.value.trim();

        // Comment to check out how server validation is working too
        if (name === "") {
          alert("Specify a name");
          return;
        }
        if (price === "" || isNaN(price)) {
          alert("Input valid price");
          return;
        }

        axios
          .post("http://127.0.0.1:3000/products/create", {
            name: name,
            price: price,
            brand: brand,
          })
          .then((response) => {
            console.log(response);
            alert(`Product inserted successfully`);
            window.location.replace("http://127.0.0.1:3000/products/all");
          })
          .catch((error) => {
            console.log(error.response.data);
            alert(`Problem when inserting product ${error.response.data}`);
          });
      });
    </script>
  </body>
</html>
